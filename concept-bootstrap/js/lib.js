d3=function(){function t(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.substring(1);for(var n=0,r=X.length;r>n;++n){var i=X[n]+e;if(i in t)return i}}function e(t){return W(t,K),t}function n(t){return"function"==typeof t?t:function(){return G(t,this)}}function r(t){return"function"==typeof t?t:function(){return V(t,this)}}function i(t,e){function n(){this.removeAttribute(t)}function r(){this.removeAttributeNS(t.space,t.local)}function i(){this.setAttribute(t,e)}function o(){this.setAttributeNS(t.space,t.local,e)}function a(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}function s(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}return t=L.ns.qualify(t),null==e?t.local?r:n:"function"==typeof e?t.local?s:a:t.local?o:i}function o(t){return t.trim().replace(/\s+/g," ")}function a(t){return new RegExp("(?:^|\\s+)"+L.requote(t)+"(?:\\s+|$)","g")}function s(t,e){function n(){for(var n=-1;++n<i;)t[n](this,e)}function r(){for(var n=-1,r=e.apply(this,arguments);++n<i;)t[n](this,r)}t=t.trim().split(/\s+/).map(u);var i=t.length;return"function"==typeof e?r:n}function u(t){var e=a(t);return function(n,r){if(i=n.classList)return r?i.add(t):i.remove(t);var i=n.getAttribute("class")||"";r?(e.lastIndex=0,e.test(i)||n.setAttribute("class",o(i+" "+t))):n.setAttribute("class",o(i.replace(e," ")))}}function c(t,e,n){function r(){this.style.removeProperty(t)}function i(){this.style.setProperty(t,e,n)}function o(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}return null==e?r:"function"==typeof e?o:i}function l(t,e){function n(){delete this[t]}function r(){this[t]=e}function i(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}return null==e?n:"function"==typeof e?i:r}function f(t){return"function"==typeof t?t:(t=L.ns.qualify(t)).local?function(){return M.createElementNS(t.space,t.local)}:function(){return M.createElementNS(this.namespaceURI,t)}}function h(t,e){try{for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}catch(r){t.prototype=e}}function p(){}function d(t){return{__data__:t}}function v(t){return function(){return Z(this,t)}}function g(t){return arguments.length||(t=L.ascending),function(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}}function m(){}function y(){}function _(t){function e(){for(var e,r=n,i=-1,o=r.length;++i<o;)(e=r[i].on)&&e.apply(this,arguments);return t}var n=[],r=new p;return e.on=function(e,i){var o,a=r.get(e);return arguments.length<2?a&&a.on:(a&&(a.on=null,n=n.slice(0,o=n.indexOf(a)).concat(n.slice(o+1)),r.remove(e)),i&&n.push(r.set(e,{on:i})),t)},e}function w(){for(var t,e=L.event;t=e.sourceEvent;)e=t;return e}function x(t,e,n){function r(){var e=this[a];e&&(this.removeEventListener(t,e,e.$),delete this[a])}function i(){var i=u(e,O(arguments));r.call(this),this.addEventListener(t,this[a]=i,i.$=n),i._=e}function o(){var e,n=new RegExp("^__on([^.]+)"+L.requote(t)+"$");for(var r in this)if(e=r.match(n)){var i=this[r];this.removeEventListener(e[1],i,i.$),delete this[r]}}var a="__on"+t,s=t.indexOf("."),u=T;s>0&&(t=t.substring(0,s));var c=ne.get(t);return c&&(t=c,u=N),s?e?i:r:e?m:o}function T(t,e){return function(n){var r=L.event;L.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{L.event=r}}}function N(t,e){var n=T(t,e);return function(t){var e=this,r=t.relatedTarget;r&&(r===e||8&r.compareDocumentPosition(e))||n.call(e,t)}}function b(t,e){for(var n=0,r=t.length;r>n;n++)for(var i,o=t[n],a=0,s=o.length;s>a;a++)(i=o[a])&&e(i,a,n);return t}function A(t){return W(t,re),t}function S(t){var e,n;return function(r,i,o){var a,s=t[o].update,u=s.length;for(o!=n&&(n=o,e=0),i>=e&&(e=i+1);!(a=s[e])&&++e<u;);return a}}function k(){var t=this.__transition__;t&&++t.active}function E(t,e){e.changedTouches&&(e=e.changedTouches[0]);var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();if(0>le&&(q.scrollX||q.scrollY)){n=L.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var i=n[0][0].getScreenCTM();le=!(i.f||i.e),n.remove()}return le?(r.x=e.pageX,r.y=e.pageY):(r.x=e.clientX,r.y=e.clientY),r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}function I(){var t=P(),e=C()-t;e>24?(isFinite(e)&&(clearTimeout(ue),ue=setTimeout(I,e)),se=0):(se=1,fe(I))}function P(){var t=Date.now();for(ce=oe;ce;)t>=ce.time&&(ce.flush=ce.callback(t-ce.time)),ce=ce.next;return t}function C(){for(var t,e=oe,n=1/0;e;)e.flush?e=t?t.next=e.next:oe=e.next:(e.time<n&&(n=e.time),e=(t=e).next);return ae=t,n}var L={version:"3.3.3"};Date.now||(Date.now=function(){return+new Date});var D=[].slice,O=function(t){return D.call(t)},M=document,R=M.documentElement,q=window;try{O(R.childNodes)[0].nodeType}catch(H){O=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t[e];return n}}try{M.createElement("div").style.setProperty("opacity",0,"")}catch(z){var $=q.Element.prototype,B=$.setAttribute,F=$.setAttributeNS,U=q.CSSStyleDeclaration.prototype,j=U.setProperty;$.setAttribute=function(t,e){B.call(this,t,e+"")},$.setAttributeNS=function(t,e,n){F.call(this,t,e,n+"")},U.setProperty=function(t,e,n){j.call(this,t,e+"",n)}}var W={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]},X=["webkit","ms","moz","Moz","o","O"],G=function(t,e){return e.querySelector(t)},V=function(t,e){return e.querySelectorAll(t)},Y=R[t(R,"matchesSelector")],Z=function(t,e){return Y.call(t,e)};"function"==typeof Sizzle&&(G=function(t,e){return Sizzle(t,e)[0]||null},V=function(t,e){return Sizzle.uniqueSort(Sizzle(t,e))},Z=Sizzle.matchesSelector),L.selection=function(){return ie};var K=L.selection.prototype=[];K.select=function(t){var r,i,o,a,s=[];t=n(t);for(var u=-1,c=this.length;++u<c;){s.push(r=[]),r.parentNode=(o=this[u]).parentNode;for(var l=-1,f=o.length;++l<f;)(a=o[l])?(r.push(i=t.call(a,a.__data__,l,u)),i&&"__data__"in a&&(i.__data__=a.__data__)):r.push(null)}return e(s)},K.selectAll=function(t){var n,i,o=[];t=r(t);for(var a=-1,s=this.length;++a<s;)for(var u=this[a],c=-1,l=u.length;++c<l;)(i=u[c])&&(o.push(n=O(t.call(i,i.__data__,c,a))),n.parentNode=i);return e(o)};var J={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};L.ns={prefix:J,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&(n=t.substring(0,e),t=t.substring(e+1)),J.hasOwnProperty(n)?{space:J[n],local:t}:t}},K.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node();return t=L.ns.qualify(t),t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(i(e,t[e]));return this}return this.each(i(t,e))},L.requote=function(t){return t.replace(Q,"\\$&")};var Q=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;K.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),r=(t=t.trim().split(/^|\s+/g)).length,i=-1;if(e=n.classList){for(;++i<r;)if(!e.contains(t[i]))return!1}else for(e=n.getAttribute("class");++i<r;)if(!a(t[i]).test(e))return!1;return!0}for(e in t)this.each(s(e,t[e]));return this}return this.each(s(t,e))},K.style=function(t,e,n){var r=arguments.length;if(3>r){if("string"!=typeof t){2>r&&(e="");for(n in t)this.each(c(n,t[n],e));return this}if(2>r)return q.getComputedStyle(this.node(),null).getPropertyValue(t);n=""}return this.each(c(t,e,n))},K.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(l(e,t[e]));return this}return this.each(l(t,e))},K.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},K.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},K.append=function(t){return t=f(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},K.insert=function(t,e){return t=f(t),e=n(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments))})},K.remove=function(){return this.each(function(){var t=this.parentNode;t&&t.removeChild(this)})},L.map=function(t){var e=new p;if(t instanceof p)t.forEach(function(t,n){e.set(t,n)});else for(var n in t)e.set(n,t[n]);return e},h(p,{has:function(t){return te+t in this},get:function(t){return this[te+t]},set:function(t,e){return this[te+t]=e},remove:function(t){return t=te+t,t in this&&delete this[t]},keys:function(){var t=[];return this.forEach(function(e){t.push(e)}),t},values:function(){var t=[];return this.forEach(function(e,n){t.push(n)}),t},entries:function(){var t=[];return this.forEach(function(e,n){t.push({key:e,value:n})}),t},forEach:function(t){for(var e in this)e.charCodeAt(0)===ee&&t.call(this,e.substring(1),this[e])}});var te="\0",ee=te.charCodeAt(0);K.data=function(t,n){function r(t,e){var r,i,o,a=t.length,s=e.length,f=Math.min(a,s),h=new Array(s),v=new Array(s),g=new Array(a);if(n){var m,y=new p,_=new p,w=[];for(r=-1;++r<a;)m=n.call(i=t[r],i.__data__,r),y.has(m)?g[r]=i:y.set(m,i),w.push(m);for(r=-1;++r<s;)m=n.call(e,o=e[r],r),(i=y.get(m))?(h[r]=i,i.__data__=o):_.has(m)||(v[r]=d(o)),_.set(m,o),y.remove(m);for(r=-1;++r<a;)y.has(w[r])&&(g[r]=t[r])}else{for(r=-1;++r<f;)i=t[r],o=e[r],i?(i.__data__=o,h[r]=i):v[r]=d(o);for(;s>r;++r)v[r]=d(e[r]);for(;a>r;++r)g[r]=t[r]}v.update=h,v.parentNode=h.parentNode=g.parentNode=t.parentNode,u.push(v),c.push(h),l.push(g)}var i,o,a=-1,s=this.length;if(!arguments.length){for(t=new Array(s=(i=this[0]).length);++a<s;)(o=i[a])&&(t[a]=o.__data__);return t}var u=A([]),c=e([]),l=e([]);if("function"==typeof t)for(;++a<s;)r(i=this[a],t.call(i,i.parentNode.__data__,a));else for(;++a<s;)r(i=this[a],t);return c.enter=function(){return u},c.exit=function(){return l},c},K.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},K.filter=function(t){var n,r,i,o=[];"function"!=typeof t&&(t=v(t));for(var a=0,s=this.length;s>a;a++){o.push(n=[]),n.parentNode=(r=this[a]).parentNode;for(var u=0,c=r.length;c>u;u++)(i=r[u])&&t.call(i,i.__data__,u)&&n.push(i)}return e(o)},K.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n,r=this[t],i=r.length-1,o=r[i];--i>=0;)(n=r[i])&&(o&&o!==n.nextSibling&&o.parentNode.insertBefore(n,o),o=n);return this},L.ascending=function(t,e){return e>t?-1:t>e?1:t>=e?0:0/0},K.sort=function(t){t=g.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},L.dispatch=function(){for(var t=new y,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=_(t);return t},y.prototype.on=function(t,e){var n=t.indexOf("."),r="";if(n>=0&&(r=t.substring(n+1),t=t.substring(0,n)),t)return arguments.length<2?this[t].on(r):this[t].on(r,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(r,null);return this}},L.event=null,K.on=function(t,e,n){var r=arguments.length;if(3>r){if("string"!=typeof t){2>r&&(e=!1);for(n in t)this.each(x(n,t[n],e));return this}if(2>r)return(r=this.node()["__on"+t])&&r._;n=!1}return this.each(x(t,e,n))};var ne=L.map({mouseenter:"mouseover",mouseleave:"mouseout"});ne.forEach(function(t){"on"+t in M&&ne.remove(t)}),K.each=function(t){return b(this,function(e,n,r){t.call(e,e.__data__,n,r)})},K.call=function(t){var e=O(arguments);return t.apply(e[0]=this,e),this},K.empty=function(){return!this.node()},K.node=function(){for(var t=0,e=this.length;e>t;t++)for(var n=this[t],r=0,i=n.length;i>r;r++){var o=n[r];if(o)return o}return null},K.size=function(){var t=0;return this.each(function(){++t}),t};var re=[];L.selection.enter=A,L.selection.enter.prototype=re,re.append=K.append,re.empty=K.empty,re.node=K.node,re.call=K.call,re.size=K.size,re.select=function(t){for(var n,r,i,o,a,s=[],u=-1,c=this.length;++u<c;){i=(o=this[u]).update,s.push(n=[]),n.parentNode=o.parentNode;for(var l=-1,f=o.length;++l<f;)(a=o[l])?(n.push(i[l]=r=t.call(o.parentNode,a.__data__,l,u)),r.__data__=a.__data__):n.push(null)}return e(s)},re.insert=function(t,e){return arguments.length<2&&(e=S(this)),K.insert.call(this,t,e)},K.transition=function(){for(var t,e,n=d3_transitionInheritId||++d3_transitionId,r=[],i=d3_transitionInherit||{time:Date.now(),ease:d3_ease_cubicInOut,delay:0,duration:250},o=-1,a=this.length;++o<a;){r.push(t=[]);for(var s=this[o],u=-1,c=s.length;++u<c;)(e=s[u])&&d3_transitionNode(e,u,n,i),t.push(e)}return d3_transition(r,n)},K.interrupt=function(){return this.each(k)},L.select=function(t){var n=["string"==typeof t?G(t,M):t];return n.parentNode=R,e([n])},L.selectAll=function(t){var n=O("string"==typeof t?V(t,M):t);return n.parentNode=R,e([n])};var ie=L.select(R);L.mouse=function(t){return E(t,w())};var oe,ae,se,ue,ce,le=/WebKit/.test(q.navigator.userAgent)?-1:0,fe=q[t(q,"requestAnimationFrame")]||function(t){setTimeout(t,17)};return L.timer=function(t,e,n){var r=arguments.length;2>r&&(e=0),3>r&&(n=Date.now());var i=n+e,o={callback:t,time:i,next:null};ae?ae.next=o:oe=o,ae=o,se||(ue=clearTimeout(ue),se=1,fe(I))},L.timer.flush=function(){P(),C()},L}(),function(){function t(t,s){t=t||"",s=s||{};for(var u in e)e.hasOwnProperty(u)&&(s.autoFix&&(s["fix_"+u]=!0),s.fix=s.fix||s["fix_"+u]);var c=[],l=function(e){t+=e},f=function(e){t=e+t},h={comment:/^<!--/,endTag:/^<\//,atomicTag:/^<\s*(script|style|noscript)[\s>]/i,startTag:/^</,chars:/^[^<]/},p={comment:function(){var e=t.indexOf("-->");return e>=0?{content:t.substr(4,e),length:e+3}:void 0},endTag:function(){var e=t.match(r);return e?{tagName:e[1],length:e[0].length}:void 0},atomicTag:function(){var e=p.startTag();if(e){var n=t.slice(e.length),r=n.match(new RegExp("([\\s\\S]*?)</"+e.tagName+"[^>]*>","i"));if(r)return{tagName:e.tagName,attrs:e.attrs,escapedAttrs:e.escapedAttrs,content:r[1],length:r[0].length+e.length}}},startTag:function(){var e=t.match(n);if(e){var r={},a={};return e[2].replace(i,function(t,e){var n=arguments[2]||arguments[3]||arguments[4]||o.test(e)&&e||null;r[e]=n,a[e]=n&&n.replace(/(^|[^\\])"/g,'$1\\"')}),{tagName:e[1],attrs:r,escapedAttrs:a,unary:e[3],length:e[0].length}}},chars:function(){var e=t.indexOf("<");return{length:e>=0?e:t.length}}},d=function(){for(var e in h)if(h[e].test(t)){a&&console.log("suspected "+e);var n=p[e]();return n?(a&&console.log("parsed "+e,n),n.type=n.type||e,n.text=t.substr(0,n.length),t=t.slice(n.length),n):null}},v=function(t){for(var e;e=d();)if(t[e.type]&&t[e.type](e)===!1)return},g=function(){var e=t;return t="",e},m=function(){return t};return s.fix&&function(){var e=/^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i,n=/^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i,r=[];r.last=function(){return this[this.length-1]},r.lastTagNameEq=function(t){var e=this.last();return e&&e.tagName&&e.tagName.toUpperCase()===t.toUpperCase()},r.containsTagName=function(t){for(var e,n=0;e=this[n];n++)if(e.tagName===t)return!0;return!1};var i=function(t){return t&&"startTag"===t.type&&(t.unary=e.test(t.tagName)||t.unary),t},o=d,a=function(){var e=t,n=i(o());return t=e,n},u=function(){var t=r.pop();f("</"+t.tagName+">")},c={startTag:function(t){var e=t.tagName;"TR"===e.toUpperCase()&&r.lastTagNameEq("TABLE")?(f("<TBODY>"),h()):s.fix_selfClose&&n.test(e)&&r.containsTagName(e)?r.lastTagNameEq(e)?u():(f("</"+t.tagName+">"),h()):t.unary||r.push(t)},endTag:function(t){var e=r.last();e?s.fix_tagSoup&&!r.lastTagNameEq(t.tagName)?u():r.pop():s.fix_tagSoup&&l()}},l=function(){o(),h()},h=function(){var t=a();t&&c[t.type]&&c[t.type](t)};d=function(){return h(),i(o())}}(),{append:l,readToken:d,readTokens:v,clear:g,rest:m,stack:c}}var e=function(){var t,e={},n=document.createElement("div");return t="<P><I></P></I>",n.innerHTML=t,e.tagSoup=n.innerHTML!==t,n.innerHTML="<P><i><P></P></i></P>",e.selfClose=2===n.childNodes.length,e}(),n=/^<([\-A-Za-z0-9_]+)((?:\s+[\w-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,r=/^<\/([\-A-Za-z0-9_]+)[^>]*>/,i=/([\-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,o=/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i,a=!1;t.supports=e,t.tokenToString=function(t){var e={comment:function(t){return"<--"+t.content+"-->"},endTag:function(t){return"</"+t.tagName+">"},atomicTag:function(t){return console.log(t),e.startTag(t)+t.content+e.endTag(t)},startTag:function(t){var e="<"+t.tagName;for(var n in t.attrs){var r=t.attrs[n];e+=" "+n+'="'+(r?r.replace(/(^|[^\\])"/g,'$1\\"'):"")+'"'}return e+(t.unary?"/>":">")},chars:function(t){return t.text}};return e[t.type](t)};for(var s in e)t.browserHasFlaw=t.browserHasFlaw||!e[s]&&s;this.htmlParser=t}(),function(){function t(){}function e(t){return"function"==typeof t}function n(t,e,n){var r,i=t&&t.length||0;for(r=0;i>r;r++)e.call(n,t[r],r)}function r(t,e,n){var r;for(r in t)t.hasOwnProperty(r)&&e.call(n,r,t[r])}function i(t,e){return r(e,function(e,n){t[e]=n}),t}function o(t,e){return t=t||{},r(e,function(e,n){null==t[e]&&(t[e]=n)}),t}function a(t){try{return f.call(t)}catch(e){var r=[];return n(t,function(t){r.push(t)}),r}}function s(t){return/^script$/i.test(t.tagName)}var u=this;if(!u.postscribe){var c=!0,l=!1,f=Array.prototype.slice,h=function(){function t(t,e,n){var i=r+e;if(2===arguments.length){var o=t.getAttribute(i);return null==o?o:String(o)}null!=n&&""!==n?t.setAttribute(i,n):t.removeAttribute(i)}function e(e){this.actuals=[e],this.proxyHistory="",this.proxyRoot=e.ownerDocument.createElement(e.nodeName),t(this.proxyRoot,"proxyof",0)}var r="data-ps-";return e.prototype.buildChunk=function(t){var e=this.actuals.length,i=[],o=[],a=[];return n(t,function(t){if(i.push(t.text),t.attrs){if(!/^noscript$/i.test(t.tagName)){var n=e++;o.push(t.text.replace(/(\/?>)/," "+r+"id="+n+" $1")),a.push("atomicTag"===t.type?"":"<"+t.tagName+" "+r+"proxyof="+n+(t.unary?"/>":">"))}}else o.push(t.text),a.push("endTag"===t.type?t.text:"")}),{tokens:t,raw:i.join(""),actual:o.join(""),proxy:a.join("")}},e.prototype.write=function(t){var e=this.buildChunk(t);if(e.actual)return e.html=this.proxyHistory+e.actual,this.proxyHistory+=e.proxy,this.proxyRoot.innerHTML=e.html,l&&(e.proxyInnerHTML=this.proxyRoot.innerHTML),this.walkNodes(),l&&(e.actualInnerHTML=this.actuals[0].innerHTML),e},e.prototype.walkNodes=function(){for(var e,n=[this.proxyRoot];null!=(e=n.shift());){var r=1===e.nodeType,i=r&&t(e,"proxyof");if(!i){r&&(this.actuals[t(e,"id")]=e,t(e,"id",null));var o=e.parentNode&&t(e.parentNode,"proxyof");o&&this.actuals[o].appendChild(e)}n.unshift.apply(n,a(e.childNodes))}},e}(),p=function(){function e(e,n){var r=e.ownerDocument;i(this,{root:e,options:o(n,{error:t}),stream:new h(e),parser:u.htmlParser("",{autoFix:!0}),doc:r,win:r.defaultView||r.parentWindow})}e.prototype.exec=function(t,e){t.run.call(this.win,this.doc),delete t.run,e()};var n=u.execScript?"execScript":"eval";return e.prototype.script_inline=function(t,e){try{this.win[n](t.expr)}catch(r){this.options.error(r)}e()},e.prototype.script_remote=function(t,e){var n=this,o=this.doc.createElement("script"),a={src:t.src,async:!0,onload:function(){o=o.onload=o.onreadystatechange=o.onerror=null,e()},onreadystatechange:function(){/^(loaded|complete)$/.test(o.readyState)&&o.onload()},onerror:function(){n.options.error({message:"remote script failed "+t.src}),o.onload()}};r(t.tok.attrs,function(t,e){a.hasOwnProperty(t)||o.setAttribute(t,e)}),i(o,a),this.root.appendChild(o)},e.prototype.write=function(t,e,n){this.parser.append(t.html);for(var r,i=[];null!=(r=this.parser.readToken())&&!s(r);)i.push(r);var o=this.stream.write(i);l&&(t.chunk=o),r&&this.onScriptToken(r,n),e()},e.prototype.onScriptToken=function(t,e){var n=this.parser.clear(),r=t.attrs.src||t.attrs.SRC;e.subtask(r?{type:"script_remote",src:r,tok:t}:{type:"script_inline",inlinable:!0,tok:t,expr:t.content.replace(/<!\[CDATA\[([\s\S]*?)\]\]>/g,"$1").replace(/<!--([\s\S]*?)-->/g,"$1")}),n&&e.subtask({type:"write",html:n,inlinable:!0})},e}(),d=function(){function n(e,n){var r=[];i(this,{worker:e,options:o(n,{taskAdd:t,taskStart:t,taskDone:t}),active:null,deferred:r,_deferred:r})}return n.prototype.task=function(t,e){return this.options.taskAdd(t),this.deferred.push(t),e&&this.deferred.push(e),this.nextIfIdle(),this},n.prototype.subtask=function(t){this.options.taskAdd(t),t.inlinable&&!this._deferred.length?this.startTask(t):this._deferred.push(t)},n.prototype.startTask=function(t){var n=this;if(this.stopRequested)return this._deferred.unshift(t);if(e(t))return t.call(this),this.nextIfIdle();var r={active:this.active,_deferred:this._deferred};i(this,{active:t,_deferred:[]}),this.options.taskStart(t),this.worker[t.type](t,function(){n.doneTask(r)},this)},n.prototype.doneTask=function(t){this.options.taskDone(this.active),[].unshift.apply(t._deferred,this._deferred),i(this,t),this.onStop&&!this.active&&(this.onStop(),delete this.onStop),this.nextIfIdle()},n.prototype.nextIfIdle=function(){var t=!this.active&&this.deferred.shift();t&&this.startTask(t)},n.prototype.stop=function(e){e=e||t,this.stopRequested=!0,this.active?this.onStop=e:e()},n.prototype.start=function(){return this.stopRequested=!1,delete this.onStop,this.nextIfIdle(),this},n}(),v=function(){function t(){i(this,{tasks:[],roots:[],active:null})}return t.prototype.taskAdd=function(t){return t.id=this.tasks.length,this.tasks.push(t),t.state="waiting",this.active&&(t.cause=this.active.id,(this.active.effects=this.active.effects||[]).push(t.id)),t},t.prototype.taskStart=function(t){var e=this.active;e?(t.parent=e.id,(e.childIds=e.childIds||[]).push(t.id),(e.children=e.children||[]).push(t)):this.roots.push(t),t.state="started",this.active=t},t.prototype.taskDone=function(t){t.state="done",this.active=null!=t.parent?this.tasks[t.parent]:null},t}(),g=function(){function n(e,n,r,s){function u(t){f.subtask({type:"write",html:t,inlinable:!0}),r.afterWrite(t)}r=o(r,{afterWrite:t,done:t});var l=new p(e,r),f=new d(l,c&&new v);f.name=r.name,a.writers[f.name]=f;var h=e.ownerDocument,g={write:h.write,writeln:h.writeln};return i(h,{write:u,writeln:function(t){u(t+"\n")}}),f.task(n,function(){i(h,g),r.done(),s()}),f}function a(n,r,o){n=/^#/.test(n)?u.document.getElementById(n.substr(1)):n.jquery?n[0]:n,o=o||{};var a=e(r)?{type:"exec",run:r}:{type:"write",html:r},c=i([n,a,o],{type:"rootTask"});return s.task(c),n.postscribe={stop:function(){c.flow?c.flow.stop():c[1]={type:"exec",run:t}}}}var s=new d({rootTask:function(t,e){t.push(e),t.flow=n.apply(null,t)}});return i(a,{writers:{},queue:s,Worker:p,Flow:d,Tracer:v,WriteStream:h,json:function(){var t={};return r(this.writers,function(e,n){t[e]=n.options.roots}),t}})}();u.postscribe=g}}();